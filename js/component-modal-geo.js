customElements.get("modal-geo")||customElements.define("modal-geo",class extends HTMLElement{constructor(){super(),this.config={userCountryKey:"userCountry",geoModalTrigger:"[data-open-geo-modal]"},this.isRedirection=new URLSearchParams(window.location.search).has("redirection"),this.countryRedirected=this.isRedirection?new URLSearchParams(window.location.search).get("country"):"",this.countries=Woolman.geoInfo.countryJson,this.userCountry=sessionStorage.getItem(this.config.userCountryKey),this.geoCurrentCountryNames=document.querySelectorAll(this.config.geoCurrentCountryName),this.geoModalTriggers=document.querySelectorAll(this.config.geoModalTrigger),this.countrySwitcher=this.querySelector("country-switcher"),this.form=this.querySelector("form"),this.countrySwitcher&&(!this.isRedirection&&this.userCountry==null&&(!Shopify.designMode||this.getAttribute("data-debug-mode")=="true"&&Shopify.designMode)&&this.runGeolocationFlow(),this.isRedirection&&this.countryRedirected&&sessionStorage.setItem(this.config.userCountryKey,this.countryRedirected),this.geoModalTriggers.forEach(trigger=>{trigger.addEventListener("click",function(){this.countrySwitcher.setSuggestedCountry(!1),this.countrySwitcher.formatSwitcher(),Woolman.ModalsAndDrawers.showModalOrDrawer("modal-geo")}.bind(this))}),this.form.addEventListener("submit",function(){this.country.handle&&sessionStorage.setItem(this.config.userCountryKey,this.country.handle)}.bind(this)),document.addEventListener("drawerOrModalClose.modal-geo",function(){this.country.handle&&sessionStorage.setItem(this.config.userCountryKey,this.country.handle)}.bind(this)))}async fetchGeolocation(){try{return(await(await fetch("/browsing_context_suggestions.json")).json()).detected_values.country}catch(err){console.log(err)}}async runGeolocationFlow(){if(this.country=await this.fetchGeolocation(),(window.location.host.split(".")[1]?window.location.host.split(".")[0]:!1)==this.countrySwitcher.config.apacSubdomain&&this.country.handle==this.countrySwitcher.config.bermudaIsoCode){this.countrySwitcher.setSuggestedCountry(this.country.handle),this.countrySwitcher.formatSwitcher(),Woolman.ModalsAndDrawers.showModalOrDrawer("modal-geo");return}this.country.handle==Shopify.country?sessionStorage.setItem(this.config.userCountryKey,this.country.handle):this.countries.findIndex(o=>o.isocode==this.country.handle)>-1&&(this.countrySwitcher.setSuggestedCountry(this.country.handle),this.countrySwitcher.formatSwitcher(),Woolman.ModalsAndDrawers.showModalOrDrawer("modal-geo"))}});
//# sourceMappingURL=/cdn/shop/t/96/assets/component-modal-geo.js.map?v=129058132806504130261744203243
